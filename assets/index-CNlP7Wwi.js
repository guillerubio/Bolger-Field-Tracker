(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=t(n);fetch(n.href,i)}})();const rs=!1;var Fs=Array.isArray,Vn=Array.prototype.indexOf,Ur=Array.from,Gn=Object.defineProperty,Er=Object.getOwnPropertyDescriptor,Bs=Object.getOwnPropertyDescriptors,Js=Object.getPrototypeOf;const pr=()=>{};function Kn(r){return r()}function Sr(r){for(var e=0;e<r.length;e++)r[e]()}const Q=2,zs=4,sr=8,qr=16,me=32,$t=64,Vt=128,X=256,Gt=512,U=1024,we=2048,Ge=4096,ye=8192,nr=16384,Wn=32768,Nr=65536,Hs=1<<17,Yn=1<<19,Vs=1<<20,dt=Symbol("$state"),Xn=Symbol("legacy props"),Qn=Symbol("");function Gs(r){return r===this.v}function Ks(r,e){return r!=r?e==e:r!==e||r!==null&&typeof r=="object"||typeof r=="function"}function Ws(r){return!Ks(r,this.v)}function Zn(r){throw new Error("https://svelte.dev/e/effect_in_teardown")}function ei(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function ti(r){throw new Error("https://svelte.dev/e/effect_orphan")}function ri(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function si(r){throw new Error("https://svelte.dev/e/props_invalid_value")}function ni(){throw new Error("https://svelte.dev/e/state_unsafe_local_read")}function ii(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let _t=!1,ai=!1;function oi(){_t=!0}const li=1,ci=2,ui=16,hi=2,Ys=1,di=2,fi=Symbol();function Xs(r){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let $=null;function ss(r){$=r}function ir(r,e=!1,t){$={p:$,c:null,e:null,m:!1,s:r,x:null,l:null},_t&&!e&&($.l={s:null,u:null,r1:[],r2:Kt(!1)})}function ar(r){const e=$;if(e!==null){const a=e.e;if(a!==null){var t=R,s=C;e.e=null;try{for(var n=0;n<a.length;n++){var i=a[n];Ue(i.effect),De(i.reaction),It(i.fn)}}finally{Ue(t),De(s)}}$=e.p,e.m=!0}return{}}function Rt(){return!_t||$!==null&&$.l===null}function Kt(r,e){var t={f:0,v:r,reactions:null,equals:Gs,rv:0,wv:0};return t}function Qs(r,e=!1){var s;const t=Kt(r);return e||(t.equals=Ws),_t&&$!==null&&$.l!==null&&((s=$.l).s??(s.s=[])).push(t),t}function B(r,e=!1){return vi(Qs(r,e))}function vi(r){return C!==null&&!ue&&C.f&Q&&(he===null?Oi([r]):he.push(r)),r}function oe(r,e){return k(r,be(()=>_(r))),e}function k(r,e){return C!==null&&!ue&&Rt()&&C.f&(Q|qr)&&(he===null||!he.includes(r))&&ii(),Wt(r,e)}function Wt(r,e){return r.equals(e)||(r.v,r.v=e,r.wv=_n(),Zs(r,we),Rt()&&R!==null&&R.f&U&&!(R.f&(me|$t))&&(_e===null?Pi([r]):_e.push(r))),e}function Zs(r,e){var t=r.reactions;if(t!==null)for(var s=Rt(),n=t.length,i=0;i<n;i++){var a=t[i],o=a.f;o&we||!s&&a===R||(se(a,e),o&(U|X)&&(o&Q?Zs(a,Ge):ur(a)))}}let Mr=!1;function ns(r){return r!==null&&typeof r=="object"&&dt in r?r[dt]:r}function _i(r,e){return Object.is(ns(r),ns(e))}var is,en,tn,rn;function pi(){if(is===void 0){is=window,en=/Firefox/.test(navigator.userAgent);var r=Element.prototype,e=Node.prototype;tn=Er(e,"firstChild").get,rn=Er(e,"nextSibling").get,r.__click=void 0,r.__className="",r.__attributes=null,r.__styles=null,r.__e=void 0,Text.prototype.__t=void 0}}function sn(r=""){return document.createTextNode(r)}function pe(r){return tn.call(r)}function or(r){return rn.call(r)}function j(r,e){return pe(r)}function St(r,e){{var t=pe(r);return t instanceof Comment&&t.data===""?or(t):t}}function w(r,e=1,t=!1){let s=r;for(;e--;)s=or(s);return s}function gi(r){r.textContent=""}function Fr(r){var e=Q|we,t=C!==null&&C.f&Q?C:null;return R===null||t!==null&&t.f&X?e|=X:R.f|=Vs,{ctx:$,deps:null,effects:null,equals:Gs,f:e,fn:r,reactions:null,rv:0,v:null,wv:0,parent:t??R}}function Br(r){const e=Fr(r);return e.equals=Ws,e}function nn(r){var e=r.effects;if(e!==null){r.effects=null;for(var t=0;t<e.length;t+=1)Le(e[t])}}function yi(r){for(var e=r.parent;e!==null;){if(!(e.f&Q))return e;e=e.parent}return null}function mi(r){var e,t=R;Ue(yi(r));try{nn(r),e=gn(r)}finally{Ue(t)}return e}function an(r){var e=mi(r),t=(Ie||r.f&X)&&r.deps!==null?Ge:U;se(r,t),r.equals(e)||(r.v=e,r.wv=_n())}function on(r){R===null&&C===null&&ti(),C!==null&&C.f&X&&R===null&&ei(),Gr&&Zn()}function wi(r,e){var t=e.last;t===null?e.last=e.first=r:(t.next=r,r.prev=t,e.last=r)}function pt(r,e,t,s=!0){var n=(r&$t)!==0,i=R,a={ctx:$,deps:null,nodes_start:null,nodes_end:null,f:r|we,first:null,fn:e,last:null,next:null,parent:n?null:i,prev:null,teardown:null,transitions:null,wv:0};if(t){var o=ut;try{as(!0),cr(a),a.f|=Wn}catch(u){throw Le(a),u}finally{as(o)}}else e!==null&&ur(a);var l=t&&a.deps===null&&a.first===null&&a.nodes_start===null&&a.teardown===null&&(a.f&(Vs|Vt))===0;if(!l&&!n&&s&&(i!==null&&wi(a,i),C!==null&&C.f&Q)){var c=C;(c.effects??(c.effects=[])).push(a)}return a}function bi(r){const e=pt(sr,null,!1);return se(e,U),e.teardown=r,e}function Tr(r){on();var e=R!==null&&(R.f&me)!==0&&$!==null&&!$.m;if(e){var t=$;(t.e??(t.e=[])).push({fn:r,effect:R,reaction:C})}else{var s=It(r);return s}}function ki(r){return on(),Lt(r)}function Ei(r){const e=pt($t,r,!0);return(t={})=>new Promise(s=>{t.outro?Yt(e,()=>{Le(e),s(void 0)}):(Le(e),s(void 0))})}function It(r){return pt(zs,r,!1)}function Jr(r,e){var t=$,s={effect:null,ran:!1};t.l.r1.push(s),s.effect=Lt(()=>{r(),!s.ran&&(s.ran=!0,k(t.l.r2,!0),be(e))})}function zr(){var r=$;Lt(()=>{if(_(r.l.r2)){for(var e of r.l.r1){var t=e.effect;t.f&U&&se(t,Ge),gt(t)&&cr(t),e.ran=!1}r.l.r2.v=!1}})}function Lt(r){return pt(sr,r,!0)}function ge(r,e=[],t=Fr){const s=e.map(t);return Hr(()=>r(...s.map(_)))}function Hr(r,e=0){return pt(sr|qr|e,r,!0)}function jt(r,e=!0){return pt(sr|me,r,!0,e)}function ln(r){var e=r.teardown;if(e!==null){const t=Gr,s=C;os(!0),De(null);try{e.call(null)}finally{os(t),De(s)}}}function cn(r,e=!1){var t=r.first;for(r.first=r.last=null;t!==null;){var s=t.next;Le(t,e),t=s}}function Si(r){for(var e=r.first;e!==null;){var t=e.next;e.f&me||Le(e),e=t}}function Le(r,e=!0){var t=!1;if((e||r.f&Yn)&&r.nodes_start!==null){for(var s=r.nodes_start,n=r.nodes_end;s!==null;){var i=s===n?null:or(s);s.remove(),s=i}t=!0}cn(r,e&&!t),tr(r,0),se(r,nr);var a=r.transitions;if(a!==null)for(const l of a)l.stop();ln(r);var o=r.parent;o!==null&&o.first!==null&&un(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes_start=r.nodes_end=null}function un(r){var e=r.parent,t=r.prev,s=r.next;t!==null&&(t.next=s),s!==null&&(s.prev=t),e!==null&&(e.first===r&&(e.first=s),e.last===r&&(e.last=t))}function Yt(r,e){var t=[];Vr(r,t,!0),hn(t,()=>{Le(r),e&&e()})}function hn(r,e){var t=r.length;if(t>0){var s=()=>--t||e();for(var n of r)n.out(s)}else e()}function Vr(r,e,t){if(!(r.f&ye)){if(r.f^=ye,r.transitions!==null)for(const a of r.transitions)(a.is_global||t)&&e.push(a);for(var s=r.first;s!==null;){var n=s.next,i=(s.f&Nr)!==0||(s.f&me)!==0;Vr(s,e,i?t:!1),s=n}}}function Xt(r){dn(r,!0)}function dn(r,e){if(r.f&ye){r.f^=ye,r.f&U||(r.f^=U),gt(r)&&(se(r,we),ur(r));for(var t=r.first;t!==null;){var s=t.next,n=(t.f&Nr)!==0||(t.f&me)!==0;dn(t,n?e:!1),t=s}if(r.transitions!==null)for(const i of r.transitions)(i.is_global||e)&&i.in()}}let Or=!1,Pr=[];function Ti(){Or=!1;const r=Pr.slice();Pr=[],Sr(r)}function fn(r){Or||(Or=!0,queueMicrotask(Ti)),Pr.push(r)}let Ht=!1,Qt=!1,Zt=null,ut=!1,Gr=!1;function as(r){ut=r}function os(r){Gr=r}let Ar=[],Tt=0;let C=null,ue=!1;function De(r){C=r}let R=null;function Ue(r){R=r}let he=null;function Oi(r){he=r}let N=null,G=0,_e=null;function Pi(r){_e=r}let vn=1,er=0,Ie=!1,He=null;function _n(){return++vn}function gt(r){var h;var e=r.f;if(e&we)return!0;if(e&Ge){var t=r.deps,s=(e&X)!==0;if(t!==null){var n,i,a=(e&Gt)!==0,o=s&&R!==null&&!Ie,l=t.length;if(a||o){var c=r,u=c.parent;for(n=0;n<l;n++)i=t[n],(a||!((h=i==null?void 0:i.reactions)!=null&&h.includes(c)))&&(i.reactions??(i.reactions=[])).push(c);a&&(c.f^=Gt),o&&u!==null&&!(u.f&X)&&(c.f^=X)}for(n=0;n<l;n++)if(i=t[n],gt(i)&&an(i),i.wv>r.wv)return!0}(!s||R!==null&&!Ie)&&se(r,U)}return!1}function Ai(r,e){for(var t=e;t!==null;){if(t.f&Vt)try{t.fn(r);return}catch{t.f^=Vt}t=t.parent}throw Ht=!1,r}function ji(r){return(r.f&nr)===0&&(r.parent===null||(r.parent.f&Vt)===0)}function lr(r,e,t,s){if(Ht){if(t===null&&(Ht=!1),ji(e))throw r;return}t!==null&&(Ht=!0);{Ai(r,e);return}}function pn(r,e,t=!0){var s=r.reactions;if(s!==null)for(var n=0;n<s.length;n++){var i=s[n];i.f&Q?pn(i,e,!1):e===i&&(t?se(i,we):i.f&U&&se(i,Ge),ur(i))}}function gn(r){var f;var e=N,t=G,s=_e,n=C,i=Ie,a=he,o=$,l=ue,c=r.f;N=null,G=0,_e=null,C=c&(me|$t)?null:r,Ie=(c&X)!==0&&(!ut||n===null||l),he=null,ss(r.ctx),ue=!1,er++;try{var u=(0,r.fn)(),h=r.deps;if(N!==null){var d;if(tr(r,G),h!==null&&G>0)for(h.length=G+N.length,d=0;d<N.length;d++)h[G+d]=N[d];else r.deps=h=N;if(!Ie)for(d=G;d<h.length;d++)((f=h[d]).reactions??(f.reactions=[])).push(r)}else h!==null&&G<h.length&&(tr(r,G),h.length=G);if(Rt()&&_e!==null&&!ue&&h!==null&&!(r.f&(Q|Ge|we)))for(d=0;d<_e.length;d++)pn(_e[d],r);return n!==null&&er++,u}finally{N=e,G=t,_e=s,C=n,Ie=i,he=a,ss(o),ue=l}}function Ci(r,e){let t=e.reactions;if(t!==null){var s=Vn.call(t,r);if(s!==-1){var n=t.length-1;n===0?t=e.reactions=null:(t[s]=t[n],t.pop())}}t===null&&e.f&Q&&(N===null||!N.includes(e))&&(se(e,Ge),e.f&(X|Gt)||(e.f^=Gt),nn(e),tr(e,0))}function tr(r,e){var t=r.deps;if(t!==null)for(var s=e;s<t.length;s++)Ci(r,t[s])}function cr(r){var e=r.f;if(!(e&nr)){se(r,U);var t=R,s=$;R=r;try{e&qr?Si(r):cn(r),ln(r);var n=gn(r);r.teardown=typeof n=="function"?n:null,r.wv=vn;var i=r.deps,a;rs&&ai&&r.f&we}catch(o){lr(o,r,t,s||r.ctx)}finally{R=t}}}function xi(){if(Tt>1e3){Tt=0;try{ri()}catch(r){if(Zt!==null)lr(r,Zt,null);else throw r}}Tt++}function $i(r){var e=r.length;if(e!==0){xi();var t=ut;ut=!0;try{for(var s=0;s<e;s++){var n=r[s];n.f&U||(n.f^=U);var i=Li(n);Ri(i)}}finally{ut=t}}}function Ri(r){var e=r.length;if(e!==0)for(var t=0;t<e;t++){var s=r[t];if(!(s.f&(nr|ye)))try{gt(s)&&(cr(s),s.deps===null&&s.first===null&&s.nodes_start===null&&(s.teardown===null?un(s):s.fn=null))}catch(n){lr(n,s,null,s.ctx)}}}function Ii(){if(Qt=!1,Tt>1001)return;const r=Ar;Ar=[],$i(r),Qt||(Tt=0,Zt=null)}function ur(r){Qt||(Qt=!0,queueMicrotask(Ii)),Zt=r;for(var e=r;e.parent!==null;){e=e.parent;var t=e.f;if(t&($t|me)){if(!(t&U))return;e.f^=U}}Ar.push(e)}function Li(r){var e=[],t=r.first;e:for(;t!==null;){var s=t.f,n=(s&me)!==0,i=n&&(s&U)!==0,a=t.next;if(!i&&!(s&ye)){if(s&zs)e.push(t);else if(n)t.f^=U;else{var o=C;try{C=t,gt(t)&&cr(t)}catch(u){lr(u,t,null,t.ctx)}finally{C=o}}var l=t.first;if(l!==null){t=l;continue}}if(a===null){let u=t.parent;for(;u!==null;){if(r===u)break e;var c=u.next;if(c!==null){t=c;continue e}u=u.parent}}t=a}return e}function _(r){var e=r.f,t=(e&Q)!==0;if(He!==null&&He.add(r),C!==null&&!ue){he!==null&&he.includes(r)&&ni();var s=C.deps;r.rv<er&&(r.rv=er,N===null&&s!==null&&s[G]===r?G++:N===null?N=[r]:(!Ie||!N.includes(r))&&N.push(r))}else if(t&&r.deps===null&&r.effects===null){var n=r,i=n.parent;i!==null&&!(i.f&X)&&(n.f^=X)}return t&&(n=r,gt(n)&&an(n)),r.v}function Di(r){var e=He;He=new Set;var t=He,s;try{if(be(r),e!==null)for(s of He)e.add(s)}finally{He=e}return t}function ls(r){var e=Di(()=>be(r));for(var t of e)if(t.f&Hs)for(const s of t.deps||[])s.f&Q||Wt(s,s.v);else Wt(t,t.v)}function be(r){var e=ue;try{return ue=!0,r()}finally{ue=e}}const Ui=-7169;function se(r,e){r.f=r.f&Ui|e}function Kr(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(dt in r)jr(r);else if(!Array.isArray(r))for(let e in r){const t=r[e];typeof t=="object"&&t&&dt in t&&jr(t)}}}function jr(r,e=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!e.has(r)){e.add(r),r instanceof Date&&r.getTime();for(let s in r)try{jr(r[s],e)}catch{}const t=Js(r);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const s=Bs(t);for(let n in s){const i=s[n].get;if(i)try{i.call(r)}catch{}}}}}const qi=["touchstart","touchmove"];function Ni(r){return qi.includes(r)}let cs=!1;function Mi(){cs||(cs=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var e;if(!r.defaultPrevented)for(const t of r.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function yn(r){var e=C,t=R;De(null),Ue(null);try{return r()}finally{De(e),Ue(t)}}function mn(r,e,t,s=t){r.addEventListener(e,()=>yn(t));const n=r.__on_r;n?r.__on_r=()=>{n(),s(!0)}:r.__on_r=()=>s(!0),Mi()}const Fi=new Set,us=new Set;function Bi(r,e,t,s={}){function n(i){if(s.capture||kt.call(e,i),!i.cancelBubble)return yn(()=>t==null?void 0:t.call(this,i))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?fn(()=>{e.addEventListener(r,n,s)}):e.addEventListener(r,n,s),n}function J(r,e,t,s,n){var i={capture:s,passive:n},a=Bi(r,e,t,i);(e===document.body||e===window||e===document)&&bi(()=>{e.removeEventListener(r,a,i)})}function kt(r){var S;var e=this,t=e.ownerDocument,s=r.type,n=((S=r.composedPath)==null?void 0:S.call(r))||[],i=n[0]||r.target,a=0,o=r.__root;if(o){var l=n.indexOf(o);if(l!==-1&&(e===document||e===window)){r.__root=e;return}var c=n.indexOf(e);if(c===-1)return;l<=c&&(a=l)}if(i=n[a]||r.target,i!==e){Gn(r,"currentTarget",{configurable:!0,get(){return i||t}});var u=C,h=R;De(null),Ue(null);try{for(var d,f=[];i!==null;){var v=i.assignedSlot||i.parentNode||i.host||null;try{var p=i["__"+s];if(p!==void 0&&!i.disabled)if(Fs(p)){var[g,...b]=p;g.apply(i,[r,...b])}else p.call(i,r)}catch(P){d?f.push(P):d=P}if(r.cancelBubble||v===e||v===null)break;i=v}if(d){for(let P of f)queueMicrotask(()=>{throw P});throw d}}finally{r.__root=e,delete r.currentTarget,De(u),Ue(h)}}}function wn(r){var e=document.createElement("template");return e.innerHTML=r,e.content}function Ct(r,e){var t=R;t.nodes_start===null&&(t.nodes_start=r,t.nodes_end=e)}function qe(r,e){var t=(e&Ys)!==0,s=(e&di)!==0,n,i=!r.startsWith("<!>");return()=>{n===void 0&&(n=wn(i?r:"<!>"+r),t||(n=pe(n)));var a=s||en?document.importNode(n,!0):n.cloneNode(!0);if(t){var o=pe(a),l=a.lastChild;Ct(o,l)}else Ct(a,a);return a}}function Wr(r,e,t="svg"){var s=!r.startsWith("<!>"),n=(e&Ys)!==0,i=`<${t}>${s?r:"<!>"+r}</${t}>`,a;return()=>{if(!a){var o=wn(i),l=pe(o);if(n)for(a=document.createDocumentFragment();pe(l);)a.appendChild(pe(l));else a=pe(l)}var c=a.cloneNode(!0);if(n){var u=pe(c),h=c.lastChild;Ct(u,h)}else Ct(c,c);return c}}function bn(){var r=document.createDocumentFragment(),e=document.createComment(""),t=sn();return r.append(e,t),Ct(e,t),r}function W(r,e){r!==null&&r.before(e)}function le(r,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(r.__t??(r.__t=r.nodeValue))&&(r.__t=t,r.nodeValue=t+"")}function Ji(r,e){return zi(r,e)}const et=new Map;function zi(r,{target:e,anchor:t,props:s={},events:n,context:i,intro:a=!0}){pi();var o=new Set,l=h=>{for(var d=0;d<h.length;d++){var f=h[d];if(!o.has(f)){o.add(f);var v=Ni(f);e.addEventListener(f,kt,{passive:v});var p=et.get(f);p===void 0?(document.addEventListener(f,kt,{passive:v}),et.set(f,1)):et.set(f,p+1)}}};l(Ur(Fi)),us.add(l);var c=void 0,u=Ei(()=>{var h=t??e.appendChild(sn());return jt(()=>{if(i){ir({});var d=$;d.c=i}n&&(s.$$events=n),c=r(h,s)||{},i&&ar()}),()=>{var v;for(var d of o){e.removeEventListener(d,kt);var f=et.get(d);--f===0?(document.removeEventListener(d,kt),et.delete(d)):et.set(d,f)}us.delete(l),h!==t&&((v=h.parentNode)==null||v.removeChild(h))}});return Hi.set(c,u),c}let Hi=new WeakMap;function Je(r,e,t=!1){var s=r,n=null,i=null,a=fi,o=t?Nr:0,l=!1;const c=(h,d=!0)=>{l=!0,u(d,h)},u=(h,d)=>{a!==(a=h)&&(a?(n?Xt(n):d&&(n=jt(()=>d(s))),i&&Yt(i,()=>{i=null})):(i?Xt(i):d&&(i=jt(()=>d(s))),n&&Yt(n,()=>{n=null})))};Hr(()=>{l=!1,e(c),l||u(null,null)},o)}function kn(r,e){return e}function Vi(r,e,t,s){for(var n=[],i=e.length,a=0;a<i;a++)Vr(e[a].e,n,!0);var o=i>0&&n.length===0&&t!==null;if(o){var l=t.parentNode;gi(l),l.append(t),s.clear(),je(r,e[0].prev,e[i-1].next)}hn(n,()=>{for(var c=0;c<i;c++){var u=e[c];o||(s.delete(u.k),je(r,u.prev,u.next)),Le(u.e,!o)}})}function En(r,e,t,s,n,i=null){var a=r,o={flags:e,items:new Map,first:null},l=null,c=!1,u=Br(()=>{var h=t();return Fs(h)?h:h==null?[]:Ur(h)});Hr(()=>{var h=_(u),d=h.length;c&&d===0||(c=d===0,Gi(h,o,a,n,e,s,t),i!==null&&(d===0?l?Xt(l):l=jt(()=>i(a)):l!==null&&Yt(l,()=>{l=null})),_(u))})}function Gi(r,e,t,s,n,i,a){var o=r.length,l=e.items,c=e.first,u=c,h,d=null,f=[],v=[],p,g,b,S;for(S=0;S<o;S+=1){if(p=r[S],g=i(p,S),b=l.get(g),b===void 0){var P=u?u.e.nodes_start:t;d=Wi(P,e,d,d===null?e.first:d.next,p,g,S,s,n,a),l.set(g,d),f=[],v=[],u=d.next;continue}if(Ki(b,p,S),b.e.f&ye&&Xt(b.e),b!==u){if(h!==void 0&&h.has(b)){if(f.length<v.length){var A=v[0],O;d=A.prev;var z=f[0],ne=f[f.length-1];for(O=0;O<f.length;O+=1)hs(f[O],A,t);for(O=0;O<v.length;O+=1)h.delete(v[O]);je(e,z.prev,ne.next),je(e,d,z),je(e,ne,A),u=A,d=ne,S-=1,f=[],v=[]}else h.delete(b),hs(b,u,t),je(e,b.prev,b.next),je(e,b,d===null?e.first:d.next),je(e,d,b),d=b;continue}for(f=[],v=[];u!==null&&u.k!==g;)u.e.f&ye||(h??(h=new Set)).add(u),v.push(u),u=u.next;if(u===null)continue;b=u}f.push(b),d=b,u=b.next}if(u!==null||h!==void 0){for(var M=h===void 0?[]:Ur(h);u!==null;)u.e.f&ye||M.push(u),u=u.next;var Z=M.length;if(Z>0){var ee=null;Vi(e,M,ee,l)}}R.first=e.first&&e.first.e,R.last=d&&d.e}function Ki(r,e,t,s){Wt(r.v,e),r.i=t}function Wi(r,e,t,s,n,i,a,o,l,c){var u=(l&li)!==0,h=(l&ui)===0,d=u?h?Qs(n):Kt(n):n,f=l&ci?Kt(a):a,v={i:f,v:d,k:i,a:null,e:null,prev:t,next:s};try{return v.e=jt(()=>o(r,d,f,c),Mr),v.e.prev=t&&t.e,v.e.next=s&&s.e,t===null?e.first=v:(t.next=v,t.e.next=v.e),s!==null&&(s.prev=v,s.e.prev=v.e),v}finally{}}function hs(r,e,t){for(var s=r.next?r.next.e.nodes_start:t,n=e?e.e.nodes_start:t,i=r.e.nodes_start;i!==s;){var a=or(i);n.before(i),i=a}}function je(r,e,t){e===null?r.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function $e(r,e,t,s){var n=r.__attributes??(r.__attributes={});n[e]!==(n[e]=t)&&(e==="style"&&"__styles"in r&&(r.__styles={}),e==="loading"&&(r[Qn]=t),t==null?r.removeAttribute(e):typeof t!="string"&&Yi(r).includes(e)?r[e]=t:r.setAttribute(e,t))}var ds=new Map;function Yi(r){var e=ds.get(r.nodeName);if(e)return e;ds.set(r.nodeName,e=[]);for(var t,s=r,n=Element.prototype;n!==s;){t=Bs(s);for(var i in t)t[i].set&&e.push(i);s=Js(s)}return e}function Xi(r,e,t){var s=r.__className,n=Sn(e);(s!==n||Mr)&&(n===""?r.removeAttribute("class"):r.setAttribute("class",n),r.__className=n)}function Qi(r,e,t){var s=r.__className,n=Sn(e);(s!==n||Mr)&&(e==null?r.removeAttribute("class"):r.className=n,r.__className=n)}function Sn(r,e){return(r??"")+""}function Ce(r,e,t=e){var s=Rt();mn(r,"input",n=>{var i=n?r.defaultValue:r.value;if(i=gr(r)?yr(i):i,t(i),s&&i!==(i=e())){var a=r.selectionStart,o=r.selectionEnd;r.value=i??"",o!==null&&(r.selectionStart=a,r.selectionEnd=Math.min(o,r.value.length))}}),be(e)==null&&r.value&&t(gr(r)?yr(r.value):r.value),Lt(()=>{var n=e();gr(r)&&n===yr(r.value)||r.type==="date"&&!n&&!r.value||n!==r.value&&(r.value=n??"")})}function gr(r){var e=r.type;return e==="number"||e==="range"}function yr(r){return r===""?null:+r}function Tn(r,e,t){if(r.multiple)return ea(r,e);for(var s of r.options){var n=Ot(s);if(_i(n,e)){s.selected=!0;return}}(!t||e!==void 0)&&(r.selectedIndex=-1)}function Zi(r,e){It(()=>{var t=new MutationObserver(()=>{var s=r.__value;Tn(r,s)});return t.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function fs(r,e,t=e){var s=!0;mn(r,"change",n=>{var i=n?"[selected]":":checked",a;if(r.multiple)a=[].map.call(r.querySelectorAll(i),Ot);else{var o=r.querySelector(i)??r.querySelector("option:not([disabled])");a=o&&Ot(o)}t(a)}),It(()=>{var n=e();if(Tn(r,n,s),s&&n===void 0){var i=r.querySelector(":checked");i!==null&&(n=Ot(i),t(n))}r.__value=n,s=!1}),Zi(r)}function ea(r,e){for(var t of r.options)t.selected=~e.indexOf(Ot(t))}function Ot(r){return"__value"in r?r.__value:r.value}function vs(r,e){return r===e||(r==null?void 0:r[dt])===e}function ta(r={},e,t,s){return It(()=>{var n,i;return Lt(()=>{n=i,i=[],be(()=>{r!==t(...i)&&(e(r,...i),n&&vs(t(...n),r)&&e(null,...n))})}),()=>{fn(()=>{i&&vs(t(...i),r)&&e(null,...i)})}}),r}function Yr(r=!1){const e=$,t=e.l.u;if(!t)return;let s=()=>Kr(e.s);if(r){let n=0,i={};const a=Fr(()=>{let o=!1;const l=e.s;for(const c in l)l[c]!==i[c]&&(i[c]=l[c],o=!0);return o&&n++,n});s=()=>_(a)}t.b.length&&ki(()=>{_s(e,s),Sr(t.b)}),Tr(()=>{const n=be(()=>t.m.map(Kn));return()=>{for(const i of n)typeof i=="function"&&i()}}),t.a.length&&Tr(()=>{_s(e,s),Sr(t.a)})}function _s(r,e){if(r.l.s)for(const t of r.l.s)_(t);e()}const tt=[];function ra(r,e=pr){let t=null;const s=new Set;function n(o){if(Ks(r,o)&&(r=o,t)){const l=!tt.length;for(const c of s)c[1](),tt.push(c,r);if(l){for(let c=0;c<tt.length;c+=2)tt[c][0](tt[c+1]);tt.length=0}}}function i(o){n(o(r))}function a(o,l=pr){const c=[o,l];return s.add(c),s.size===1&&(t=e(n,i)||pr),o(r),()=>{s.delete(c),s.size===0&&t&&(t(),t=null)}}return{set:n,update:i,subscribe:a}}let Nt=!1;function sa(r){var e=Nt;try{return Nt=!1,[r(),Nt]}finally{Nt=e}}function ce(r,e,t,s){var v;var n=!_t||(t&hi)!==0,i=!1,a;[a,i]=sa(()=>r[e]);var o=dt in r||Xn in r,l=(((v=Er(r,e))==null?void 0:v.set)??(o&&e in r&&(p=>r[e]=p)))||void 0,c=s,u=!0,h=()=>(u&&(u=!1,c=s),c);a===void 0&&s!==void 0&&(l&&n&&si(),a=h(),l&&l(a));var d;if(n)d=()=>{var p=r[e];return p===void 0?h():(u=!0,p)};else{var f=Br(()=>r[e]);f.f|=Hs,d=()=>{var p=_(f);return p!==void 0&&(c=void 0),p===void 0?c:p}}return d}function na(r){$===null&&Xs(),_t&&$.l!==null?aa($).m.push(r):Tr(()=>{const e=be(r);if(typeof e=="function")return e})}function ia(r){$===null&&Xs(),na(()=>()=>be(r))}function aa(r){var e=r.l;return e.u??(e.u={a:[],b:[],m:[]})}const oa="5";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(oa);oi();const la="modulepreload",ca=function(r){return"/Bolger-Field-Tracker/"+r},ps={},ft=function(e,t,s){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));n=Promise.allSettled(t.map(l=>{if(l=ca(l),l in ps)return;ps[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":la,c||(h.as="script"),h.crossOrigin="",h.href=l,o&&h.setAttribute("nonce",o),document.head.appendChild(h),c)return new Promise((d,f)=>{h.addEventListener("load",d),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return n.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})},ua=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>ft(async()=>{const{default:s}=await Promise.resolve().then(()=>yt);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class Xr extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class ha extends Xr{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class da extends Xr{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class fa extends Xr{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Cr;(function(r){r.Any="any",r.ApNortheast1="ap-northeast-1",r.ApNortheast2="ap-northeast-2",r.ApSouth1="ap-south-1",r.ApSoutheast1="ap-southeast-1",r.ApSoutheast2="ap-southeast-2",r.CaCentral1="ca-central-1",r.EuCentral1="eu-central-1",r.EuWest1="eu-west-1",r.EuWest2="eu-west-2",r.EuWest3="eu-west-3",r.SaEast1="sa-east-1",r.UsEast1="us-east-1",r.UsWest1="us-west-1",r.UsWest2="us-west-2"})(Cr||(Cr={}));var va=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?i(u.value):n(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class _a{constructor(e,{headers:t={},customFetch:s,region:n=Cr.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=ua(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return va(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:a}=t;let o={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let c;a&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=a):typeof a=="string"?(o["Content-Type"]="text/plain",c=a):typeof FormData<"u"&&a instanceof FormData?c=a:(o["Content-Type"]="application/json",c=JSON.stringify(a)));const u=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),n),body:c}).catch(v=>{throw new ha(v)}),h=u.headers.get("x-relay-error");if(h&&h==="true")throw new da(u);if(!u.ok)throw new fa(u);let d=((s=u.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),f;return d==="application/json"?f=yield u.json():d==="application/octet-stream"?f=yield u.blob():d==="text/event-stream"?f=u:d==="multipart/form-data"?f=yield u.formData():f=yield u.text(),{data:f,error:null}}catch(n){return{data:null,error:n}}})}}function pa(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function ga(r){if(r.__esModule)return r;var e=r.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(r).forEach(function(s){var n=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(t,s,n.get?n:{enumerable:!0,get:function(){return r[s]}})}),t}var L={},rt={},st={},nt={},it={},at={},ya=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},vt=ya();const ma=vt.fetch,On=vt.fetch.bind(vt),Pn=vt.Headers,wa=vt.Request,ba=vt.Response,yt=Object.freeze(Object.defineProperty({__proto__:null,Headers:Pn,Request:wa,Response:ba,default:On,fetch:ma},Symbol.toStringTag,{value:"Module"})),ka=ga(yt);var Mt={},gs;function An(){if(gs)return Mt;gs=1,Object.defineProperty(Mt,"__esModule",{value:!0});class r extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Mt.default=r,Mt}var ys;function jn(){if(ys)return at;ys=1;var r=at&&at.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(at,"__esModule",{value:!0});const e=r(ka),t=r(An());class s{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,a){return this.headers=Object.assign({},this.headers),this.headers[i]=a,this}then(i,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,h,d;let f=null,v=null,p=null,g=c.status,b=c.statusText;if(c.ok){if(this.method!=="HEAD"){const O=await c.text();O===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?v=O:v=JSON.parse(O))}const P=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),A=(h=c.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");P&&A&&A.length>1&&(p=parseInt(A[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(v)&&(v.length>1?(f={code:"PGRST116",details:`Results contain ${v.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},v=null,p=null,g=406,b="Not Acceptable"):v.length===1?v=v[0]:v=null)}else{const P=await c.text();try{f=JSON.parse(P),Array.isArray(f)&&c.status===404&&(v=[],f=null,g=200,b="OK")}catch{c.status===404&&P===""?(g=204,b="No Content"):f={message:P}}if(f&&this.isMaybeSingle&&(!((d=f==null?void 0:f.details)===null||d===void 0)&&d.includes("0 rows"))&&(f=null,g=200,b="OK"),f&&this.shouldThrowOnError)throw new t.default(f)}return{error:f,data:v,count:p,status:g,statusText:b}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,h,d;return{error:{message:`${(u=c==null?void 0:c.name)!==null&&u!==void 0?u:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(h=c==null?void 0:c.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(d=c==null?void 0:c.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,a)}}return at.default=s,at}var ms;function Cn(){if(ms)return it;ms=1;var r=it&&it.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(it,"__esModule",{value:!0});const e=r(jn());class t extends e.default{select(n){let i=!1;const a=(n??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(n,{ascending:i=!0,nullsFirst:a,foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${n}.${i?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:i,referencedTable:a=i}={}){const o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(o,`${n}`),this}range(n,i,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"offset":`${o}.offset`,c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${n}`),this.url.searchParams.set(c,`${i-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:n=!1,verbose:i=!1,settings:a=!1,buffers:o=!1,wal:l=!1,format:c="text"}={}){var u;const h=[n?"analyze":null,i?"verbose":null,a?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),d=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${d}"; options=${h};`,c==="json"?this:this}rollback(){var n;return((n=this.headers.Prefer)!==null&&n!==void 0?n:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return it.default=t,it}var ws;function Qr(){if(ws)return nt;ws=1;var r=nt&&nt.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(nt,"__esModule",{value:!0});const e=r(Cn());class t extends e.default{eq(n,i){return this.url.searchParams.append(n,`eq.${i}`),this}neq(n,i){return this.url.searchParams.append(n,`neq.${i}`),this}gt(n,i){return this.url.searchParams.append(n,`gt.${i}`),this}gte(n,i){return this.url.searchParams.append(n,`gte.${i}`),this}lt(n,i){return this.url.searchParams.append(n,`lt.${i}`),this}lte(n,i){return this.url.searchParams.append(n,`lte.${i}`),this}like(n,i){return this.url.searchParams.append(n,`like.${i}`),this}likeAllOf(n,i){return this.url.searchParams.append(n,`like(all).{${i.join(",")}}`),this}likeAnyOf(n,i){return this.url.searchParams.append(n,`like(any).{${i.join(",")}}`),this}ilike(n,i){return this.url.searchParams.append(n,`ilike.${i}`),this}ilikeAllOf(n,i){return this.url.searchParams.append(n,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(n,i){return this.url.searchParams.append(n,`ilike(any).{${i.join(",")}}`),this}is(n,i){return this.url.searchParams.append(n,`is.${i}`),this}in(n,i){const a=Array.from(new Set(i)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(n,`in.(${a})`),this}contains(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cs.{${i.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(i)}`),this}containedBy(n,i){return typeof i=="string"?this.url.searchParams.append(n,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(n,`cd.{${i.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(i)}`),this}rangeGt(n,i){return this.url.searchParams.append(n,`sr.${i}`),this}rangeGte(n,i){return this.url.searchParams.append(n,`nxl.${i}`),this}rangeLt(n,i){return this.url.searchParams.append(n,`sl.${i}`),this}rangeLte(n,i){return this.url.searchParams.append(n,`nxr.${i}`),this}rangeAdjacent(n,i){return this.url.searchParams.append(n,`adj.${i}`),this}overlaps(n,i){return typeof i=="string"?this.url.searchParams.append(n,`ov.${i}`):this.url.searchParams.append(n,`ov.{${i.join(",")}}`),this}textSearch(n,i,{config:a,type:o}={}){let l="";o==="plain"?l="pl":o==="phrase"?l="ph":o==="websearch"&&(l="w");const c=a===void 0?"":`(${a})`;return this.url.searchParams.append(n,`${l}fts${c}.${i}`),this}match(n){return Object.entries(n).forEach(([i,a])=>{this.url.searchParams.append(i,`eq.${a}`)}),this}not(n,i,a){return this.url.searchParams.append(n,`not.${i}.${a}`),this}or(n,{foreignTable:i,referencedTable:a=i}={}){const o=a?`${a}.or`:"or";return this.url.searchParams.append(o,`(${n})`),this}filter(n,i,a){return this.url.searchParams.append(n,`${i}.${a}`),this}}return nt.default=t,nt}var bs;function xn(){if(bs)return st;bs=1;var r=st&&st.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(st,"__esModule",{value:!0});const e=r(Qr());class t{constructor(n,{headers:i={},schema:a,fetch:o}){this.url=n,this.headers=i,this.schema=a,this.fetch=o}select(n,{head:i=!1,count:a}={}){const o=i?"HEAD":"GET";let l=!1;const c=(n??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),a&&(this.headers.Prefer=`count=${a}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(n,{count:i,defaultToNull:a=!0}={}){const o="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),a||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(n)){const c=n.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}upsert(n,{onConflict:i,ignoreDuplicates:a=!1,count:o,defaultToNull:l=!0}={}){const c="POST",u=[`resolution=${a?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&u.push(this.headers.Prefer),o&&u.push(`count=${o}`),l||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(n)){const h=n.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(h.length>0){const d=[...new Set(h)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}update(n,{count:i}={}){const a="PATCH",o=[];return this.headers.Prefer&&o.push(this.headers.Prefer),i&&o.push(`count=${i}`),this.headers.Prefer=o.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:this.fetch,allowEmpty:!1})}delete({count:n}={}){const i="DELETE",a=[];return n&&a.push(`count=${n}`),this.headers.Prefer&&a.unshift(this.headers.Prefer),this.headers.Prefer=a.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return st.default=t,st}var mt={},wt={},ks;function Ea(){return ks||(ks=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.version=void 0,wt.version="0.0.0-automated"),wt}var Es;function Sa(){if(Es)return mt;Es=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.DEFAULT_HEADERS=void 0;const r=Ea();return mt.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${r.version}`},mt}var Ss;function Ta(){if(Ss)return rt;Ss=1;var r=rt&&rt.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(rt,"__esModule",{value:!0});const e=r(xn()),t=r(Qr()),s=Sa();class n{constructor(a,{headers:o={},schema:l,fetch:c}={}){this.url=a,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),o),this.schemaName=l,this.fetch=c}from(a){const o=new URL(`${this.url}/${a}`);return new e.default(o,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new n(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:l=!1,get:c=!1,count:u}={}){let h;const d=new URL(`${this.url}/rpc/${a}`);let f;l||c?(h=l?"HEAD":"GET",Object.entries(o).filter(([p,g])=>g!==void 0).map(([p,g])=>[p,Array.isArray(g)?`{${g.join(",")}}`:`${g}`]).forEach(([p,g])=>{d.searchParams.append(p,g)})):(h="POST",f=o);const v=Object.assign({},this.headers);return u&&(v.Prefer=`count=${u}`),new t.default({method:h,url:d,headers:v,schema:this.schemaName,body:f,fetch:this.fetch,allowEmpty:!1})}}return rt.default=n,rt}var Ts;function Oa(){if(Ts)return L;Ts=1;var r=L&&L.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(L,"__esModule",{value:!0}),L.PostgrestError=L.PostgrestBuilder=L.PostgrestTransformBuilder=L.PostgrestFilterBuilder=L.PostgrestQueryBuilder=L.PostgrestClient=void 0;const e=r(Ta());L.PostgrestClient=e.default;const t=r(xn());L.PostgrestQueryBuilder=t.default;const s=r(Qr());L.PostgrestFilterBuilder=s.default;const n=r(Cn());L.PostgrestTransformBuilder=n.default;const i=r(jn());L.PostgrestBuilder=i.default;const a=r(An());return L.PostgrestError=a.default,L.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:i.default,PostgrestError:a.default},L}var Pa=Oa();const Aa=pa(Pa),{PostgrestClient:ja,PostgrestQueryBuilder:Ol,PostgrestFilterBuilder:Pl,PostgrestTransformBuilder:Al,PostgrestBuilder:jl,PostgrestError:Cl}=Aa,Ca="2.11.2",xa={"X-Client-Info":`realtime-js/${Ca}`},$a="1.0.0",$n=1e4,Ra=1e3;var ht;(function(r){r[r.connecting=0]="connecting",r[r.open=1]="open",r[r.closing=2]="closing",r[r.closed=3]="closed"})(ht||(ht={}));var K;(function(r){r.closed="closed",r.errored="errored",r.joined="joined",r.joining="joining",r.leaving="leaving"})(K||(K={}));var re;(function(r){r.close="phx_close",r.error="phx_error",r.join="phx_join",r.reply="phx_reply",r.leave="phx_leave",r.access_token="access_token"})(re||(re={}));var xr;(function(r){r.websocket="websocket"})(xr||(xr={}));var Ve;(function(r){r.Connecting="connecting",r.Open="open",r.Closing="closing",r.Closed="closed"})(Ve||(Ve={}));class Ia{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const n=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=s.decode(e.slice(a,a+n));a=a+n;const l=s.decode(e.slice(a,a+i));a=a+i;const c=JSON.parse(s.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class Rn{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var x;(function(r){r.abstime="abstime",r.bool="bool",r.date="date",r.daterange="daterange",r.float4="float4",r.float8="float8",r.int2="int2",r.int4="int4",r.int4range="int4range",r.int8="int8",r.int8range="int8range",r.json="json",r.jsonb="jsonb",r.money="money",r.numeric="numeric",r.oid="oid",r.reltime="reltime",r.text="text",r.time="time",r.timestamp="timestamp",r.timestamptz="timestamptz",r.timetz="timetz",r.tsrange="tsrange",r.tstzrange="tstzrange"})(x||(x={}));const Os=(r,e,t={})=>{var s;const n=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,a)=>(i[a]=La(a,r,e,n),i),{})},La=(r,e,t,s)=>{const n=e.find(o=>o.name===r),i=n==null?void 0:n.type,a=t[r];return i&&!s.includes(i)?In(i,a):$r(a)},In=(r,e)=>{if(r.charAt(0)==="_"){const t=r.slice(1,r.length);return Na(e,t)}switch(r){case x.bool:return Da(e);case x.float4:case x.float8:case x.int2:case x.int4:case x.int8:case x.numeric:case x.oid:return Ua(e);case x.json:case x.jsonb:return qa(e);case x.timestamp:return Ma(e);case x.abstime:case x.date:case x.daterange:case x.int4range:case x.int8range:case x.money:case x.reltime:case x.text:case x.time:case x.timestamptz:case x.timetz:case x.tsrange:case x.tstzrange:return $r(e);default:return $r(e)}},$r=r=>r,Da=r=>{switch(r){case"t":return!0;case"f":return!1;default:return r}},Ua=r=>{if(typeof r=="string"){const e=parseFloat(r);if(!Number.isNaN(e))return e}return r},qa=r=>{if(typeof r=="string")try{return JSON.parse(r)}catch(e){return console.log(`JSON parse error: ${e}`),r}return r},Na=(r,e)=>{if(typeof r!="string")return r;const t=r.length-1,s=r[t];if(r[0]==="{"&&s==="}"){let i;const a=r.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>In(e,o))}return r},Ma=r=>typeof r=="string"?r.replace(" ","T"):r,Ln=r=>{let e=r;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class mr{constructor(e,t,s={},n=$n){this.channel=e,this.event=t,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ps;(function(r){r.SYNC="sync",r.JOIN="join",r.LEAVE="leave"})(Ps||(Ps={}));class Pt{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},n=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Pt.syncState(this.state,n,i,a),this.pendingDiffs.forEach(l=>{this.state=Pt.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},n=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=Pt.syncDiff(this.state,n,i,a),o())}),this.onJoin((n,i,a)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:a})}),this.onLeave((n,i,a)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,n){const i=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(i,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const h=i[c];if(h){const d=u.map(g=>g.presence_ref),f=h.map(g=>g.presence_ref),v=u.filter(g=>f.indexOf(g.presence_ref)<0),p=h.filter(g=>d.indexOf(g.presence_ref)<0);v.length>0&&(o[c]=v),p.length>0&&(l[c]=p)}else o[c]=u}),this.syncDiff(i,{joins:o,leaves:l},s,n)}static syncDiff(e,t,s,n){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),n||(n=()=>{}),this.map(i,(o,l)=>{var c;const u=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),u.length>0){const h=e[o].map(f=>f.presence_ref),d=u.filter(f=>h.indexOf(f.presence_ref)<0);e[o].unshift(...d)}s(o,u,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[o]=c,n(o,c,l),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const n=e[s];return"metas"in n?t[s]=n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[s]=n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var As;(function(r){r.ALL="*",r.INSERT="INSERT",r.UPDATE="UPDATE",r.DELETE="DELETE"})(As||(As={}));var js;(function(r){r.BROADCAST="broadcast",r.PRESENCE="presence",r.POSTGRES_CHANGES="postgres_changes",r.SYSTEM="system"})(js||(js={}));var ve;(function(r){r.SUBSCRIBED="SUBSCRIBED",r.TIMED_OUT="TIMED_OUT",r.CLOSED="CLOSED",r.CHANNEL_ERROR="CHANNEL_ERROR"})(ve||(ve={}));class Zr{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=K.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new mr(this,re.join,this.params,this.timeout),this.rejoinTimer=new Rn(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=K.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=K.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=K.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=K.errored,this.rejoinTimer.scheduleTimeout())}),this._on(re.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new Pt(this),this.broadcastEndpointURL=Ln(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,n;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:a,private:o}}=this.params;this._onError(u=>e==null?void 0:e(ve.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(ve.CLOSED));const l={},c={broadcast:i,presence:a,postgres_changes:(n=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(u=>u.filter))!==null&&n!==void 0?n:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:u})=>{var h;if(this.socket.setAuth(),u===void 0){e==null||e(ve.SUBSCRIBED);return}else{const d=this.bindings.postgres_changes,f=(h=d==null?void 0:d.length)!==null&&h!==void 0?h:0,v=[];for(let p=0;p<f;p++){const g=d[p],{filter:{event:b,schema:S,table:P,filter:A}}=g,O=u&&u[p];if(O&&O.event===b&&O.schema===S&&O.table===P&&O.filter===A)v.push(Object.assign(Object.assign({},g),{id:O.id}));else{this.unsubscribe(),e==null||e(ve.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(ve.SUBSCRIBED);return}}).receive("error",u=>{e==null||e(ve.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(ve.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,n;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((n=c.body)===null||n===void 0?void 0:n.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=K.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(re.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(s=>{const n=new mr(this,re.leave,{},e);n.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})})}async _fetchWithTimeout(e,t,s){const n=new AbortController,i=setTimeout(()=>n.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(i),a}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new mr(this,e,t,s);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var n,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=re;if(s&&[o,l,c,u].indexOf(a)>=0&&s!==this._joinRef())return;let d=this._onMessage(a,t,s);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(f=>{var v,p,g;return((v=f.filter)===null||v===void 0?void 0:v.event)==="*"||((g=(p=f.filter)===null||p===void 0?void 0:p.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===a}).map(f=>f.callback(d,s)):(i=this.bindings[a])===null||i===void 0||i.filter(f=>{var v,p,g,b,S,P;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in f){const A=f.id,O=(v=f.filter)===null||v===void 0?void 0:v.event;return A&&((p=t.ids)===null||p===void 0?void 0:p.includes(A))&&(O==="*"||(O==null?void 0:O.toLocaleLowerCase())===((g=t.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const A=(S=(b=f==null?void 0:f.filter)===null||b===void 0?void 0:b.event)===null||S===void 0?void 0:S.toLocaleLowerCase();return A==="*"||A===((P=t==null?void 0:t.event)===null||P===void 0?void 0:P.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===a}).map(f=>{if(typeof d=="object"&&"ids"in d){const v=d.data,{schema:p,table:g,commit_timestamp:b,type:S,errors:P}=v;d=Object.assign(Object.assign({},{schema:p,table:g,commit_timestamp:b,eventType:S,new:{},old:{},errors:P}),this._getPayloadRecords(v))}f.callback(d,s)})}_isClosed(){return this.state===K.closed}_isJoined(){return this.state===K.joined}_isJoining(){return this.state===K.joining}_isLeaving(){return this.state===K.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const n=e.toLocaleLowerCase(),i={type:n,filter:t,callback:s};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(n=>{var i;return!(((i=n.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Zr.isEqual(n.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(re.close,{},e)}_onError(e){this._on(re.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=K.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Os(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Os(e.columns,e.old_record)),t}}const Fa=()=>{},Ba=typeof WebSocket<"u",Ja=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class za{constructor(e,t){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=xa,this.params={},this.timeout=$n,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Fa,this.conn=null,this.sendBuffer=[],this.serializer=new Ia,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>ft(async()=>{const{default:l}=await Promise.resolve().then(()=>yt);return{default:l}},void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${xr.websocket}`,this.httpEndpoint=Ln(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const n=(s=t==null?void 0:t.params)===null||s===void 0?void 0:s.apikey;if(n&&(this.accessTokenValue=n,this.apiKey=n),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,a)=>a(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Rn(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(Ba){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Ha(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),ft(async()=>{const{default:e}=await import("./browser-aOB-HDmx.js").then(t=>t.b);return{default:e}},[]).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:$a}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case ht.connecting:return Ve.Connecting;case ht.open:return Ve.Open;case ht.closing:return Ve.Closing;default:return Ve.Closed}}isConnected(){return this.connectionState()===Ve.Open}channel(e,t={config:{}}){const s=new Zr(`realtime:${e}`,t,this);return this.channels.push(s),s}push(e){const{topic:t,event:s,payload:n,ref:i}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${s} (${i})`,n),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let s=null;try{s=JSON.parse(atob(t.split(".")[1]))}catch{}if(s&&s.exp&&!(Math.floor(Date.now()/1e3)-s.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${s.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${s.exp}`);this.accessTokenValue=t,this.channels.forEach(n=>{t&&n.updateJoinPayload({access_token:t}),n.joinedOnce&&n._isJoined()&&n._push(re.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Ra,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:s,event:n,payload:i,ref:a}=t;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${n} ${a&&"("+a+")"||""}`,i),this.channels.filter(o=>o._isMember(s)).forEach(o=>o._trigger(n,i,a)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(re.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",n=new URLSearchParams(t);return`${e}${s}${n}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([Ja],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}}class Ha{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=ht.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class es extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function D(r){return typeof r=="object"&&r!==null&&"__isStorageError"in r}class Va extends es{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Rr extends es{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Ga=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?i(u.value):n(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const Dn=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>ft(async()=>{const{default:s}=await Promise.resolve().then(()=>yt);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Ka=()=>Ga(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ft(()=>Promise.resolve().then(()=>yt),void 0)).Response:Response}),Ir=r=>{if(Array.isArray(r))return r.map(t=>Ir(t));if(typeof r=="function"||r!==Object(r))return r;const e={};return Object.entries(r).forEach(([t,s])=>{const n=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[n]=Ir(s)}),e};var Ke=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?i(u.value):n(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const wr=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Wa=(r,e,t)=>Ke(void 0,void 0,void 0,function*(){const s=yield Ka();r instanceof s&&!(t!=null&&t.noResolveJson)?r.json().then(n=>{e(new Va(wr(n),r.status||500))}).catch(n=>{e(new Rr(wr(n),n))}):e(new Rr(wr(r),r))}),Ya=(r,e,t,s)=>{const n={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s&&(n.body=JSON.stringify(s)),Object.assign(Object.assign({},n),t))};function Dt(r,e,t,s,n,i){return Ke(this,void 0,void 0,function*(){return new Promise((a,o)=>{r(t,Ya(e,s,n,i)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>Wa(l,o,s))})})}function rr(r,e,t,s){return Ke(this,void 0,void 0,function*(){return Dt(r,"GET",e,t,s)})}function xe(r,e,t,s,n){return Ke(this,void 0,void 0,function*(){return Dt(r,"POST",e,s,n,t)})}function Xa(r,e,t,s,n){return Ke(this,void 0,void 0,function*(){return Dt(r,"PUT",e,s,n,t)})}function Qa(r,e,t,s){return Ke(this,void 0,void 0,function*(){return Dt(r,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function Un(r,e,t,s,n){return Ke(this,void 0,void 0,function*(){return Dt(r,"DELETE",e,s,n,t)})}var F=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?i(u.value):n(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const Za={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Cs={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class eo{constructor(e,t={},s,n){this.url=e,this.headers=t,this.bucketId=s,this.fetch=Dn(n)}uploadOrUpdate(e,t,s,n){return F(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},Cs),n);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=s,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),n!=null&&n.headers&&(o=Object.assign(Object.assign({},o),n.headers));const c=this._removeEmptyFolders(t),u=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),d=yield h.json();return h.ok?{data:{path:c,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(i){if(D(i))return{data:null,error:i};throw i}})}upload(e,t,s){return F(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,n){return F(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:Cs.upsert},n),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",c.cacheControl)):(l=s,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),d=yield h.json();return h.ok?{data:{path:i,fullPath:d.Key},error:null}:{data:null,error:d}}catch(l){if(D(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return F(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const n=Object.assign({},this.headers);t!=null&&t.upsert&&(n["x-upsert"]="true");const i=yield xe(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:n}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new es("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(s){if(D(s))return{data:null,error:s};throw s}})}update(e,t,s){return F(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return F(this,void 0,void 0,function*(){try{return{data:yield xe(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(D(n))return{data:null,error:n};throw n}})}copy(e,t,s){return F(this,void 0,void 0,function*(){try{return{data:{path:(yield xe(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(D(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,s){return F(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),i=yield xe(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(n){if(D(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,s){return F(this,void 0,void 0,function*(){try{const n=yield xe(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:n.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(n){if(D(n))return{data:null,error:n};throw n}})}download(e,t){return F(this,void 0,void 0,function*(){const n=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield rr(this.fetch,`${this.url}/${n}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(D(o))return{data:null,error:o};throw o}})}info(e){return F(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield rr(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Ir(s),error:null}}catch(s){if(D(s))return{data:null,error:s};throw s}})}exists(e){return F(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Qa(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(D(s)&&s instanceof Rr){const n=s.originalError;if([400,404].includes(n==null?void 0:n.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),n=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${s}${c}`)}}}remove(e){return F(this,void 0,void 0,function*(){try{return{data:yield Un(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(D(t))return{data:null,error:t};throw t}})}list(e,t,s){return F(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Za),t),{prefix:e||""});return{data:yield xe(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){if(D(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const to="2.7.1",ro={"X-Client-Info":`storage-js/${to}`};var ot=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?i(u.value):n(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class so{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},ro),t),this.fetch=Dn(s)}listBuckets(){return ot(this,void 0,void 0,function*(){try{return{data:yield rr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(D(e))return{data:null,error:e};throw e}})}getBucket(e){return ot(this,void 0,void 0,function*(){try{return{data:yield rr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(D(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return ot(this,void 0,void 0,function*(){try{return{data:yield xe(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(D(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return ot(this,void 0,void 0,function*(){try{return{data:yield Xa(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(D(s))return{data:null,error:s};throw s}})}emptyBucket(e){return ot(this,void 0,void 0,function*(){try{return{data:yield xe(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(D(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ot(this,void 0,void 0,function*(){try{return{data:yield Un(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(D(t))return{data:null,error:t};throw t}})}}class no extends so{constructor(e,t={},s){super(e,t,s)}from(e){return new eo(this.url,this.headers,e,this.fetch)}}const io="2.48.1";let Et="";typeof Deno<"u"?Et="deno":typeof document<"u"?Et="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Et="react-native":Et="node";const ao={"X-Client-Info":`supabase-js-${Et}/${io}`},oo={headers:ao},lo={schema:"public"},co={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},uo={};var ho=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?i(u.value):n(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};const fo=r=>{let e;return r?e=r:typeof fetch>"u"?e=On:e=fetch,(...t)=>e(...t)},vo=()=>typeof Headers>"u"?Pn:Headers,_o=(r,e,t)=>{const s=fo(t),n=vo();return(i,a)=>ho(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:r;let c=new n(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",r),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(i,Object.assign(Object.assign({},a),{headers:c}))})};var po=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?i(u.value):n(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};function go(r){return r.replace(/\/$/,"")}function yo(r,e){const{db:t,auth:s,realtime:n,global:i}=r,{db:a,auth:o,realtime:l,global:c}=e,u={db:Object.assign(Object.assign({},a),t),auth:Object.assign(Object.assign({},o),s),realtime:Object.assign(Object.assign({},l),n),global:Object.assign(Object.assign({},c),i),accessToken:()=>po(this,void 0,void 0,function*(){return""})};return r.accessToken?u.accessToken=r.accessToken:delete u.accessToken,u}const qn="2.67.3",mo="http://localhost:9999",wo="supabase.auth.token",bo={"X-Client-Info":`gotrue-js/${qn}`},xs=10,Lr="X-Supabase-Api-Version",Nn={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function ko(r){return Math.round(Date.now()/1e3)+r}function Eo(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const e=Math.random()*16|0;return(r=="x"?e:e&3|8).toString(16)})}const ae=()=>typeof window<"u"&&typeof document<"u",Be={tested:!1,writable:!1},At=()=>{if(!ae())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Be.tested)return Be.writable;const r=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(r,r),globalThis.localStorage.removeItem(r),Be.tested=!0,Be.writable=!0}catch{Be.tested=!0,Be.writable=!1}return Be.writable};function So(r){const e={},t=new URL(r);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((n,i)=>{e[i]=n})}catch{}return t.searchParams.forEach((s,n)=>{e[n]=s}),e}const Mn=r=>{let e;return r?e=r:typeof fetch>"u"?e=(...t)=>ft(async()=>{const{default:s}=await Promise.resolve().then(()=>yt);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},To=r=>typeof r=="object"&&r!==null&&"status"in r&&"ok"in r&&"json"in r&&typeof r.json=="function",Fn=async(r,e,t)=>{await r.setItem(e,JSON.stringify(t))},Ft=async(r,e)=>{const t=await r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Bt=async(r,e)=>{await r.removeItem(e)};function Oo(r){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",s,n,i,a,o,l,c,u=0;for(r=r.replace("-","+").replace("_","/");u<r.length;)a=e.indexOf(r.charAt(u++)),o=e.indexOf(r.charAt(u++)),l=e.indexOf(r.charAt(u++)),c=e.indexOf(r.charAt(u++)),s=a<<2|o>>4,n=(o&15)<<4|l>>2,i=(l&3)<<6|c,t=t+String.fromCharCode(s),l!=64&&n!=0&&(t=t+String.fromCharCode(n)),c!=64&&i!=0&&(t=t+String.fromCharCode(i));return t}class hr{constructor(){this.promise=new hr.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}hr.promiseConstructor=Promise;function $s(r){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=r.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=t[1];return JSON.parse(Oo(s))}async function Po(r){return await new Promise(e=>{setTimeout(()=>e(null),r)})}function Ao(r,e){return new Promise((s,n)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await r(i);if(!e(i,null,a)){s(a);return}}catch(a){if(!e(i,a)){n(a);return}}})()})}function jo(r){return("0"+r.toString(16)).substr(-2)}function Co(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let n="";for(let i=0;i<56;i++)n+=t.charAt(Math.floor(Math.random()*s));return n}return crypto.getRandomValues(e),Array.from(e,jo).join("")}async function xo(r){const t=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(s);return Array.from(n).map(i=>String.fromCharCode(i)).join("")}function $o(r){return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ro(r){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),r;const t=await xo(r);return $o(t)}async function lt(r,e,t=!1){const s=Co();let n=s;t&&(n+="/PASSWORD_RECOVERY"),await Fn(r,`${e}-code-verifier`,n);const i=await Ro(s);return[i,s===i?"plain":"s256"]}const Io=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Lo(r){const e=r.headers.get(Lr);if(!e||!e.match(Io))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class ts extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function E(r){return typeof r=="object"&&r!==null&&"__isAuthError"in r}class Do extends ts{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function Uo(r){return E(r)&&r.name==="AuthApiError"}class Bn extends ts{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class We extends ts{constructor(e,t,s,n){super(e,s,n),this.name=t,this.status=s}}class Pe extends We{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function qo(r){return E(r)&&r.name==="AuthSessionMissingError"}class br extends We{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Jt extends We{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class zt extends We{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function No(r){return E(r)&&r.name==="AuthImplicitGrantRedirectError"}class Rs extends We{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Dr extends We{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function kr(r){return E(r)&&r.name==="AuthRetryableFetchError"}class Is extends We{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}var Mo=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};const ze=r=>r.msg||r.message||r.error_description||r.error||JSON.stringify(r),Fo=[502,503,504];async function Ls(r){var e;if(!To(r))throw new Dr(ze(r),0);if(Fo.includes(r.status))throw new Dr(ze(r),r.status);let t;try{t=await r.json()}catch(i){throw new Bn(ze(i),i)}let s;const n=Lo(r);if(n&&n.getTime()>=Nn["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new Is(ze(t),r.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Pe}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new Is(ze(t),r.status,t.weak_password.reasons);throw new Do(ze(t),r.status||500,s)}const Bo=(r,e,t,s)=>{const n={method:r,headers:(e==null?void 0:e.headers)||{}};return r==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),t))};async function T(r,e,t,s){var n;const i=Object.assign({},s==null?void 0:s.headers);i[Lr]||(i[Lr]=Nn["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const a=(n=s==null?void 0:s.query)!==null&&n!==void 0?n:{};s!=null&&s.redirectTo&&(a.redirect_to=s.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Jo(r,e,t+o,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function Jo(r,e,t,s,n,i){const a=Bo(e,s,n,i);let o;try{o=await r(t,Object.assign({},a))}catch(l){throw console.error(l),new Dr(ze(l),0)}if(o.ok||await Ls(o),s!=null&&s.noResolveJson)return o;try{return await o.json()}catch(l){await Ls(l)}}function Ae(r){var e;let t=null;Go(r)&&(t=Object.assign({},r),r.expires_at||(t.expires_at=ko(r.expires_in)));const s=(e=r.user)!==null&&e!==void 0?e:r;return{data:{session:t,user:s},error:null}}function Ds(r){const e=Ae(r);return!e.error&&r.weak_password&&typeof r.weak_password=="object"&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.message&&typeof r.weak_password.message=="string"&&r.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=r.weak_password),e}function Re(r){var e;return{data:{user:(e=r.user)!==null&&e!==void 0?e:r},error:null}}function zo(r){return{data:r,error:null}}function Ho(r){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:i}=r,a=Mo(r,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:s,redirect_to:n,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function Vo(r){return r}function Go(r){return r.access_token&&r.refresh_token&&r.expires_in}var Ko=function(r,e){var t={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&e.indexOf(s)<0&&(t[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,s=Object.getOwnPropertySymbols(r);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(r,s[n])&&(t[s[n]]=r[s[n]]);return t};class Wo{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=Mn(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await T(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(E(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await T(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Re})}catch(s){if(E(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=Ko(e,["options"]),n=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(n.new_email=s==null?void 0:s.newEmail,delete n.newEmail),await T(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Ho,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(E(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await T(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Re})}catch(t){if(E(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,n,i,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await T(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(i=(n=e==null?void 0:e.perPage)===null||n===void 0?void 0:n.toString())!==null&&i!==void 0?i:""},xform:Vo});if(u.error)throw u.error;const h=await u.json(),d=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(v=>{const p=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(v.split(";")[1].split("=")[1]);c[`${g}Page`]=p}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(E(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await T(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Re})}catch(t){if(E(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await T(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Re})}catch(s){if(E(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){try{return await T(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Re})}catch(s){if(E(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:t,error:s}=await T(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:t,error:s}}catch(t){if(E(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await T(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(E(t))return{data:null,error:t};throw t}}}const Yo={getItem:r=>At()?globalThis.localStorage.getItem(r):null,setItem:(r,e)=>{At()&&globalThis.localStorage.setItem(r,e)},removeItem:r=>{At()&&globalThis.localStorage.removeItem(r)}};function Us(r={}){return{getItem:e=>r[e]||null,setItem:(e,t)=>{r[e]=t},removeItem:e=>{delete r[e]}}}function Xo(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ct={debug:!!(globalThis&&At()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Jn extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Qo extends Jn{}async function Zo(r,e,t){ct.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",r,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),ct.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",r)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(r,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async n=>{if(n){ct.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",r,n.name);try{return await t()}finally{ct.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",r,n.name)}}else{if(e===0)throw ct.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",r),new Qo(`Acquiring an exclusive Navigator LockManager lock "${r}" immediately failed`);if(ct.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Xo();const el={url:mo,storageKey:wo,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:bo,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},bt=30*1e3,qs=3;async function Ns(r,e,t){return await t()}class xt{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=xt.nextInstanceID,xt.nextInstanceID+=1,this.instanceID>0&&ae()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},el),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Wo({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Mn(n.fetch),this.lock=n.lock||Ns,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:ae()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Zo:this.lock=Ns,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?n.storage?this.storage=n.storage:At()?this.storage=Yo:(this.memoryStorage={},this.storage=Us(this.memoryStorage)):(this.memoryStorage={},this.storage=Us(this.memoryStorage)),ae()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${qn}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=So(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),ae()&&this.detectSessionInUrl&&s!=="none"){const{data:n,error:i}=await this._getSessionFromURL(t,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),No(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:o}=n;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return E(t)?{error:t}:{error:new Bn("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,n;try{const i=await T(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.captchaToken}},xform:Ae}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(E(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,s,n;try{let i;if("email"in e){const{email:u,password:h,options:d}=e;let f=null,v=null;this.flowType==="pkce"&&([f,v]=await lt(this.storage,this.storageKey)),i=await T(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:u,password:h,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:v},xform:Ae})}else if("phone"in e){const{phone:u,password:h,options:d}=e;i=await T(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=d==null?void 0:d.data)!==null&&s!==void 0?s:{},channel:(n=d==null?void 0:d.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Ae})}else throw new Jt("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(E(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await T(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Ds})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await T(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Ds})}else throw new Jt("You must provide either an email or phone number and a password");const{data:s,error:n}=t;return n?{data:{user:null,session:null},error:n}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new br}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:n})}catch(t){if(E(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,n,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await Ft(this.storage,`${this.storageKey}-code-verifier`),[s,n]=(t??"").split("/");try{const{data:i,error:a}=await T(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Ae});if(await Bt(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new br}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:n??null}),error:a})}catch(i){if(E(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:s,token:n,access_token:i,nonce:a}=e,o=await T(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:n,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Ae}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new br}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(E(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,n,i,a;try{if("email"in e){const{email:o,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await lt(this.storage,this.storageKey));const{error:h}=await T(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:u}=await T(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new Jt("You must provide either an email or phone number.")}catch(o){if(E(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,s;try{let n,i;"options"in e&&(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:o}=await T(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:n,xform:Ae});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(n){if(E(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,s,n;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await lt(this.storage,this.storageKey)),await T(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((n=e==null?void 0:e.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:zo})}catch(i){if(E(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Pe;const{error:n}=await T(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(E(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:n,options:i}=e,{error:a}=await T(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:s,type:n,options:i}=e,{data:a,error:o}=await T(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:n,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new Jt("You must provide either an email or phone number and a type")}catch(t){if(E(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Ft(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await T(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Re}):await this._useSession(async t=>{var s,n,i;const{data:a,error:o}=t;if(o)throw o;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Pe}:await T(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0,xform:Re})})}catch(t){if(E(t))return qo(t)&&(await this._removeSession(),await Bt(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:n,error:i}=s;if(i)throw i;if(!n.session)throw new Pe;const a=n.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await lt(this.storage,this.storageKey));const{data:c,error:u}=await T(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:Re});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(s){if(E(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return $s(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Pe;const t=Date.now()/1e3;let s=t,n=!0,i=null;const a=$s(e.access_token);if(a.exp&&(s=a.exp,n=s<=t),n){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(E(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Pe;const{session:n,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(E(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!ae())throw new zt("No browser detected.");if(e.error||e.error_description||e.error_code)throw new zt(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Rs("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new zt("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Rs("No code detected.");const{data:S,error:P}=await this._exchangeCodeForSession(e.code);if(P)throw P;const A=new URL(window.location.href);return A.searchParams.delete("code"),window.history.replaceState(window.history.state,"",A.toString()),{data:{session:S.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:n,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=e;if(!i||!o||!a||!c)throw new zt("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(o);let d=u+h;l&&(d=parseInt(l));const f=d-u;f*1e3<=bt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const v=d-h;u-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,d,u):u-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,d,u);const{data:p,error:g}=await this._getUser(i);if(g)throw g;const b={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:h,expires_at:d,refresh_token:a,token_type:c,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:e.type},error:null}}catch(s){if(E(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Ft(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:n,error:i}=t;if(i)return{error:i};const a=(s=n.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(Uo(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await Bt(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=Eo(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,n;try{const{data:{session:i},error:a}=t;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let s=null,n=null;this.flowType==="pkce"&&([s,n]=await lt(this.storage,this.storageKey,!0));try{return await T(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(E(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(E(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:n}=await this._useSession(async i=>{var a,o,l,c,u;const{data:h,error:d}=i;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await T(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(n)throw n;return ae()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(E(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,n;const{data:i,error:a}=t;if(a)throw a;return await T(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&n!==void 0?n:void 0})})}catch(t){if(E(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await Ao(async n=>(n>0&&await Po(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await T(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ae})),(n,i)=>{const a=200*Math.pow(2,n);return i&&kr(i)&&Date.now()+a-s<bt})}catch(s){if(this._debug(t,"error",s),E(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),ae()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await Ft(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s)){this._debug(t,"session is not valid"),s!==null&&await this._removeSession();return}const n=Math.round(Date.now()/1e3),i=((e=s.expires_at)!==null&&e!==void 0?e:1/0)<n+xs;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${xs}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),kr(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(t,"error",s),console.error(s);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Pe;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new hr;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new Pe;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(n,"error",i),E(i)){const a={session:null,error:i};return kr(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,s=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Fn(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Bt(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ae()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),bt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((s.expires_at*1e3-e)/bt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${bt}ms, refresh threshold is ${qs} ticks`),n<=qs&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Jn)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ae()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const n=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&n.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&n.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,a]=await lt(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});n.push(o.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);n.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&n.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;return i?{data:null,error:i}:await T(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(E(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,n;const{data:i,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await T(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((n=l==null?void 0:l.totp)===null||n===void 0)&&n.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(E(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;if(i)return{data:null,error:i};const{data:a,error:o}=await T(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(E(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:n,error:i}=t;return i?{data:null,error:i}:await T(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=n==null?void 0:n.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(E(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],n=s.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=s.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:s,totp:n,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:n},error:i}=e;if(i)return{data:null,error:i};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(n.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((s=(t=n.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}}xt.nextInstanceID=0;const tl=xt;class rl extends tl{constructor(e){super(e)}}var sl=function(r,e,t,s){function n(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(h){a(h)}}function l(u){try{c(s.throw(u))}catch(h){a(h)}}function c(u){u.done?i(u.value):n(u.value).then(o,l)}c((s=s.apply(r,e||[])).next())})};class nl{constructor(e,t,s){var n,i,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=go(e);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:lo,realtime:uo,auth:Object.assign(Object.assign({},co),{storageKey:l}),global:oo},u=yo(s??{},c);this.storageKey=(n=u.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=u.auth)!==null&&a!==void 0?a:{},this.headers,u.global.fetch),this.fetch=_o(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new ja(`${o}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new _a(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new no(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return sl(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,storageKey:i,flowType:a,lock:o,debug:l},c,u){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new rl({url:this.authUrl,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:n,flowType:a,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new za(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const il=(r,e,t)=>new nl(r,e,t),al="https://vdvnlvflxrcyvltzcque.supabase.co",ol="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZkdm5sdmZseHJjeXZsdHpjcXVlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzk2OTY3MjIsImV4cCI6MjA1NTI3MjcyMn0.AOrk4cXU4jO1BFccWfhUUIwS4JNqyEKsT4JX-2dpjMc",dr=il(al,ol),zn=ra([]);async function fr(){const{data:r,error:e}=await dr.from("regions").select("*");e?console.error("Error fetching regions:",e):zn.set(r)}fr();async function ll(r){const{error:e}=await dr.from("regions").insert([r]);e?console.error("Error adding region:",e):await fr()}async function cl(r){const{error:e}=await dr.from("regions").delete().match({id:r});e?console.error("Error deleting region:",e):await fr()}async function ul(r){const{error:e}=await dr.from("regions").update(r).match({id:r.id});e?console.error("Error updating region:",e):await fr()}const hl="/Bolger-Field-Tracker/assets/map-image-DxNZ7SkT.png";var dl=qe('<div class="expanded-info svelte-uw1qwb"><h3> </h3> <p> </p> <p> </p> <p> </p> <p> </p> <p> </p> <p> </p> <p> </p> <button>Close</button> <button>Edit</button> <button class="delete-btn svelte-uw1qwb">Delete</button></div>'),fl=qe('<div class="expanded-info svelte-uw1qwb"><h3>Edit Field</h3> <label class="svelte-uw1qwb">Name: <input class="svelte-uw1qwb"></label> <label class="svelte-uw1qwb">Details: <textarea class="svelte-uw1qwb"></textarea></label> <label class="svelte-uw1qwb">Status: <select class="svelte-uw1qwb"><option>1 - Poor</option><option>2</option><option>3</option><option>4</option><option>5 - Ready to use</option></select></label> <label class="svelte-uw1qwb">Comments: <textarea class="svelte-uw1qwb"></textarea></label> <label class="svelte-uw1qwb">Use Date: <input type="date" class="svelte-uw1qwb"></label> <label class="svelte-uw1qwb">Separations: <input type="number" min="1" max="20" class="svelte-uw1qwb"></label> <label class="svelte-uw1qwb">Management: <select class="svelte-uw1qwb"><option>Exclusion</option><option>Rotation</option></select></label> <label class="svelte-uw1qwb">Hectares: <input type="number" step="0.01" class="svelte-uw1qwb"></label> <button>Save</button> <button style="margin-left:10px;">Cancel</button></div>');function vl(r,e){ir(e,!1);let t=ce(e,"region",8),s=ce(e,"onClose",8,()=>{}),n=ce(e,"onDelete",8,()=>{}),i=ce(e,"onUpdate",8,()=>{}),a=ce(e,"onShapeEdit",8,()=>{}),o=B(!1),l=B({...t()});function c(){k(o,!0),a()()}async function u(){await i()(_(l)),k(o,!1)}function h(){k(o,!1),k(l,{...t()})}Jr(()=>Kr(t()),()=>{t()&&k(l,{...t()})}),zr(),Yr();var d=bn(),f=St(d);{var v=g=>{var b=dl(),S=j(b),P=j(S),A=w(S,2),O=j(A),z=w(A,2),ne=j(z),M=w(z,2),Z=j(M),ee=w(M,2),ke=j(ee),Ee=w(ee,2),Ye=j(Ee),Xe=w(Ee,2),Qe=j(Xe),Ne=w(Xe,2),Ze=j(Ne),Se=w(Ne,2),de=w(Se,2),Me=w(de,2);ge(()=>{le(P,t().name),le(O,t().details),le(ne,`Status: ${t().status??""}`),le(Z,`Comments: ${t().comments??""}`),le(ke,`Use Date: ${t().use_date??""}`),le(Ye,`Separations: ${t().separations??""}`),le(Qe,`Management: ${t().management_type??""}`),le(Ze,`Hectares: ${t().hectares??""}`)}),J("click",Se,function(...Te){var Fe;(Fe=s())==null||Fe.apply(this,Te)}),J("click",de,c),J("click",Me,()=>n()(t())),W(g,b)},p=g=>{var b=fl(),S=w(j(b),2),P=w(j(S)),A=w(S,2),O=w(j(A)),z=w(A,2),ne=w(j(z));ge(()=>{_(l),ls(()=>{})});var M=j(ne);M.value=(M.__value="1")==null?"":"1";var Z=w(M);Z.value=(Z.__value="2")==null?"":"2";var ee=w(Z);ee.value=(ee.__value="3")==null?"":"3";var ke=w(ee);ke.value=(ke.__value="4")==null?"":"4";var Ee=w(ke);Ee.value=(Ee.__value="5")==null?"":"5";var Ye=w(z,2),Xe=w(j(Ye)),Qe=w(Ye,2),Ne=w(j(Qe)),Ze=w(Qe,2),Se=w(j(Ze)),de=w(Ze,2),Me=w(j(de));ge(()=>{_(l),ls(()=>{})});var Te=j(Me);Te.value=(Te.__value="Exclusion")==null?"":"Exclusion";var Fe=w(Te);Fe.value=(Fe.__value="Rotation")==null?"":"Rotation";var Ut=w(de,2),vr=w(j(Ut)),qt=w(Ut,2),y=w(qt,2);Ce(P,()=>_(l).name,m=>oe(l,_(l).name=m)),Ce(O,()=>_(l).details,m=>oe(l,_(l).details=m)),fs(ne,()=>_(l).status,m=>oe(l,_(l).status=m)),Ce(Xe,()=>_(l).comments,m=>oe(l,_(l).comments=m)),Ce(Ne,()=>_(l).use_date,m=>oe(l,_(l).use_date=m)),Ce(Se,()=>_(l).separations,m=>oe(l,_(l).separations=m)),fs(Me,()=>_(l).management_type,m=>oe(l,_(l).management_type=m)),Ce(vr,()=>_(l).hectares,m=>oe(l,_(l).hectares=m)),J("click",qt,u),J("click",y,h),W(g,b)};Je(f,g=>{_(o)?g(p,!1):g(v)})}W(r,d),ar()}var _l=Wr('<circle r="10" class="draggable-handle svelte-1p15il"></circle>'),pl=Wr('<polygon class="draggable-polygon svelte-1p15il"></polygon><!>',1);function Ms(r,e){ir(e,!1);let t=ce(e,"points",8,""),s=ce(e,"onChange",8,h=>{}),n=ce(e,"onDragStart",8,()=>{}),i=ce(e,"onDragEnd",8,()=>{}),a=B([]);function o(h,d){h.preventDefault(),h.stopPropagation(),n()(),h.target.setPointerCapture(h.pointerId);const f=h.clientX,v=h.clientY,p=[..._(a)[d]];function g(S){const P=S.clientX-f,A=S.clientY-v;oe(a,_(a)[d][0]=p[0]+P),oe(a,_(a)[d][1]=p[1]+A);const O=_(a).map(z=>`${Math.round(z[0])},${Math.round(z[1])}`).join(" ");s()(O)}function b(S){h.target.releasePointerCapture(S.pointerId),window.removeEventListener("pointermove",g),window.removeEventListener("pointerup",b),i()()}window.addEventListener("pointermove",g),window.addEventListener("pointerup",b)}Jr(()=>Kr(t()),()=>{k(a,t().trim().split(" ").map(h=>h.split(",").map(Number)))}),zr(),Yr();var l=pl(),c=St(l),u=w(c);En(u,1,()=>_(a),kn,(h,d,f)=>{var v=_l();ge(()=>{$e(v,"cx",_(d)[0]),$e(v,"cy",_(d)[1])}),J("pointerdown",v,p=>o(p,f)),W(h,v)}),ge(()=>$e(c,"points",t())),W(r,l),ar()}var gl=qe('<button class="svelte-1mq0k6y">Create Field</button>'),yl=qe('<div class="create-field-panel svelte-1mq0k6y"><h3>Creating a new field</h3> <label class="svelte-1mq0k6y">Name: <input placeholder="Field name"></label> <label class="svelte-1mq0k6y">Info: <input placeholder="Short info"></label> <div class="button-row svelte-1mq0k6y"><button class="svelte-1mq0k6y">Save Field</button> <button class="svelte-1mq0k6y">Cancel</button> <button class="svelte-1mq0k6y">Undo Last Point</button></div></div>'),ml=qe('<div class="region-info-fixed svelte-1mq0k6y"><!></div>'),wl=Wr('<polygon></polygon><text class="region-label svelte-1mq0k6y"> </text>',1),bl=qe('<div class="hover-info svelte-1mq0k6y"> </div>'),kl=qe('<div class="top-panel svelte-1mq0k6y"><!> <!></div> <!> <div><svg class="map-svg svelte-1mq0k6y" viewBox="0 0 2648 1582" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg"><image x="0" y="0" width="2648" height="1582" draggable="false"></image><!><!></svg> <!></div>',1);function El(r,e){ir(e,!1);let t=B(null),s=B(null),n=B(!1),i=B(""),a=B(""),o=B(""),l=B(!1),c=B(""),u=B(),h=B([]);const d=zn.subscribe(y=>{k(h,y)});ia(()=>{d()});function f(y){k(s,y)}function v(y,m){_(n)||(m.stopPropagation(),k(t,y),k(l,!1))}function p(){k(n,!0),k(i,""),k(a,""),k(o,""),k(t,null),k(l,!1)}function g(y){if(!_(n))return;const m=y.target.tagName.toLowerCase();if(m!=="svg"&&m!=="image")return;const I=y.currentTarget.getBoundingClientRect(),te=2648/I.width,ie=1582/I.height,Y=y.clientX-I.left,H=y.clientY-I.top,V=Math.round(Y*te),q=Math.round(H*ie);k(i,_(i)?_(i)+` ${V},${q}`:`${V},${q}`)}function b(){if(!_(i))return;const y=_(i).trim().split(" ");y.pop(),k(i,y.join(" "))}async function S(){if(!_(a).trim()||_(i).trim().split(" ").length<3){alert("Please provide a field name and at least 3 points.");return}const y={name:_(a).trim(),points:_(i),info:_(o).trim()||"Short info on hover",details:"Expanded details on click"};await ll(y),k(n,!1),k(i,""),k(a,""),k(o,"")}function P(){k(n,!1),k(i,""),k(a,""),k(o,"")}async function A(y){await cl(y.id),k(t,null)}async function O(y){_(l)&&(y.points=_(c),k(l,!1)),await ul(y),k(t,y)}function z(){k(t,null),k(l,!1)}function ne(){_(t)&&(k(l,!0),k(c,_(t).points))}function M(y){const m=y.trim().split(" ").map(Y=>Y.split(",").map(Number));let I=0,te=0,ie=0;for(let Y=0;Y<m.length;Y++){const[H,V]=m[Y],[q,Oe]=m[(Y+1)%m.length],fe=H*Oe-q*V;I+=fe,te+=(H+q)*fe,ie+=(V+Oe)*fe}return I/=2,te/=6*I,ie/=6*I,{x:te,y:ie}}let Z=B("");Jr(()=>(_(t),_(u)),()=>{if(_(t)&&_(u)){const y=_(u).getBoundingClientRect(),m=M(_(t).points),I=y.width/2648,te=m.x*I;k(Z,te<y.width/2?"position: fixed; top: 20px; right: 20px;":"position: fixed; top: 20px; left: 20px;")}else k(Z,"")}),zr(),Yr();var ee=kl(),ke=St(ee),Ee=j(ke);{var Ye=y=>{var m=gl();J("click",m,p),W(y,m)};Je(Ee,y=>{_(n)||y(Ye)})}var Xe=w(Ee,2);{var Qe=y=>{var m=yl(),I=w(j(m),2),te=w(j(I)),ie=w(I,2),Y=w(j(ie)),H=w(ie,2),V=j(H),q=w(V,2),Oe=w(q,2);Ce(te,()=>_(a),fe=>k(a,fe)),Ce(Y,()=>_(o),fe=>k(o,fe)),J("click",V,S),J("click",q,P),J("click",Oe,b),W(y,m)};Je(Xe,y=>{_(n)&&y(Qe)})}var Ne=w(ke,2);{var Ze=y=>{var m=ml(),I=j(m);vl(I,{get region(){return _(t)},onClose:z,onDelete:A,onUpdate:O,onShapeEdit:ne}),ge(()=>$e(m,"style",_(Z))),W(y,m)};Je(Ne,y=>{_(t)&&!_(n)&&y(Ze)})}var Se=w(Ne,2),de=j(Se),Me=j(de);$e(Me,"href",hl);var Te=w(Me);En(Te,1,()=>_(h),kn,(y,m)=>{var I=bn(),te=St(I);{var ie=H=>{Ms(H,{get points(){return _(c)},onChange:V=>k(c,V)})},Y=H=>{var V=wl(),q=St(V),Oe=w(q),fe=j(Oe);ge((_r,Hn)=>{$e(q,"points",_(m).points),Xi(q,`region ${(_(n)?"no-pointer":"")??""} svelte-1mq0k6y`),$e(Oe,"x",_r),$e(Oe,"y",Hn),le(fe,_(m).name)},[()=>M(_(m).points).x,()=>M(_(m).points).y],Br),J("mouseover",q,()=>f(_(m))),J("mouseout",q,()=>k(s,null)),J("click",q,_r=>v(_(m),_r)),W(H,V)};Je(te,H=>{_(t)&&_(l)&&_(m).id===_(t).id?H(ie):H(Y,!1)})}W(y,I)});var Fe=w(Te);{var Ut=y=>{Ms(y,{get points(){return _(i)},onChange:m=>k(i,m)})};Je(Fe,y=>{_(n)&&_(i).trim().split(" ").length>=2&&y(Ut)})}var vr=w(de,2);{var qt=y=>{var m=bl(),I=j(m);ge(()=>le(I,_(s).info)),W(y,m)};Je(vr,y=>{_(s)&&y(qt)})}ta(Se,y=>k(u,y),()=>_(u)),ge(()=>Qi(Se,`map-container ${(_(n)?"create-mode":"")??""} svelte-1mq0k6y`)),J("click",de,g),W(r,ee),ar()}var Sl=qe('<main class="svelte-19w2whe"><h1 class="svelte-19w2whe">Haras de la Gesse Field Mapping</h1> <!></main>');function Tl(r,e){ce(e,"name",8);var t=Sl(),s=w(j(t),2);El(s,{}),W(r,t)}Ji(Tl,{target:document.getElementById("app")});export{pa as g};
